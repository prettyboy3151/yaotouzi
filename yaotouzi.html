<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>摇骰子游戏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        .left-container {
            width: 58%;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #fff;
            padding-bottom: 0px;
        }
        .stats-container {
            width: 100%;
            height: auto;
            padding: 10px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            border-bottom: 2px solid #ccc;
        }
        .stats-container h3 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 16px;
            font-weight: normal;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
        }
        .stats-grid2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            text-align: center;
        }
        .stats-item {
            font-size: 16px;
        }
        .balance-container {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            border-bottom: 2px solid #ccc;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .balance-info {
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
        }
        #betInfo {
            display: flex;
            flex-direction: column;
            gap: 8px;
            font-size: 14px;
            color: black;
            text-align: left;
            max-height: 220px;
            overflow-y: auto;
            padding-right: 5px;
        }
        .balance-container span {
            font-size: 14px;
            font-weight: normal;
        }
        #balanceAmount {
            color: #00bbd4;
            font-size: 18px;
            font-weight: bold;
            margin-right: 10px;
        }
        .dice-container {
            width: 100%;
            height: auto;
            display: grid;
            grid-template-areas: "dice1 dice2 dice3";
            grid-template-columns: 60px;
            grid-template-rows: 60px 70px 0px;
            justify-content: center;
            align-items: center;
            gap: 0px;
            perspective: 1000px;
            margin-bottom: 10px;
            position: fixed;
            bottom: 40px;
            left: 30%;
            transform: translateX(-50%);
            z-index: 1000;
        }
        .auto-roll-container {
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            position: fixed;
            bottom: 80px;
            left: 30%;
            transform: translateX(-50%);
            z-index: 1000;
        }
        .auto-roll-container input[type="number"] {
            width: 60px;
            padding: 5px;
            font-size: 16px;
        }
        .dice {
            width: 42px;
            height: 42px;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(0deg) rotateY(0deg);
            background-color: white;
            margin: 10px;
        }
        #dice1 {
            grid-area: dice1;
            justify-self: center;
        }
        #dice2 {
            grid-area: dice2;
            justify-self: end;
        }
        #dice3 {
            grid-area: dice3;
            justify-self: start;
        }
        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            grid-column: span 3;
            justify-self: center;
        }
        .dice .face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #00bbd4;
            border: 0px solid #ccc;
            border-radius: 0px;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }
        .dice .front { transform: translateZ(21px); }
        .dice .back { transform: rotateY(180deg) translateZ(21px); }
        .dice .left { transform: rotateY(-90deg) translateZ(21px); }
        .dice .right { transform: rotateY(90deg) translateZ(21px); }
        .dice .top { transform: rotateX(90deg) translateZ(21px); }
        .dice .bottom { transform: rotateX(-90deg) translateZ(21px); }
        @keyframes roll {
            0% { transform: rotateX(0deg) rotateY(0deg); }
            100% { transform: rotateX(720deg) rotateY(720deg); }
        }
        .right-container {
            width: 50%;
            height: 100vh;
            background-color: black;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-left: 0px;
            padding-right: 0px;
            box-sizing: border-box;
        }
        .record-container {
            width: 100%;
            height: calc(100vh - 30px);
            overflow-y: auto;
            font-size: 16px;
        }
        .record-item {
            margin-bottom: 10px;
            padding: 5px;
        }
        .record-item.red { color: red; }
        .record-item.yellow { color: yellow; }
        .record-item.green { color: green; }
        .dice-image {
            width: 30px;
            height: 30px;
        }
        #rollButton {
            position: fixed;
            bottom: 5px;
            left: 30%;
            transform: translateX(-50%);
            width: 140px;
            height: 60px;
            border-radius: 100px;
            background-color: rgb(255, 193, 7);
            font-size: 16px;
            cursor: pointer;
            z-index: 1000;
        }
        #betButton {
            margin-left: 5px;
            margin-top: 0px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            background-color: #00bbd4;
            color: white;
            border: none;
            border-radius: 5px;
        }
        #betButton:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }
        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            max-height: 70vh;
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            position: relative;
        }
        .modal-body {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 10px;
            padding-right: 17px;
            margin-right: -17px;
            scrollbar-width: thin;
            scrollbar-color: #888 #f1f1f1;
        }
        .modal-footer {
            padding-top: 0px;
            padding-bottom: 0px;
            border-top: 1px solid #eee;
            margin-top: 0px;
            display: flex;
            justify-content: center;
            gap: 20px;
            height: 80px;
        }
        .dice-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin: 10px 0;
        }
        .modal-content h3 {
            font-size: 16px;
            font-weight: normal;
            margin: 10px 0;
        }
        .close {
            position: absolute;
            right: 0px;
            top: 0px;
            color: #33333;
            float: right;
            font-size: 32px;
            font-weight: nomal;
            cursor: pointer;
        }
        .close:hover {
            color: black;
        }
        .dice-option {
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            background-color: white;
            border: 2px solid #00bbd4;
            color: black;
            border-radius: 5px;
            cursor: pointer;
            margin: 2px;
        }
        .dice-option.selected {
            background-color: #00bbd4;
            color: #fff;
        }
        #confirmBet, #cancelBet {
            margin: 20px;
            padding: 10px 30px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }
        #confirmBet {
            background-color: #00bbd4;
            color: white;
        }
        #cancelBet {
            color: black;
        }
        #rollButton {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        #pointOptions {
            display: flex;
            justify-content: space-between;
            flex-wrap: nowrap;
            margin: 10px 0;
        }
        #doubleOptions {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            margin: 10px 0;
        }
        #doubleOptions .dice-option {
            width: calc(20% - 4px);
            margin: 2px;
            box-sizing: border-box;
        }
        #singleOptions {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            margin: 10px 0;
        }
        #singleOptions .dice-option {
            width: calc(20% - 4px);
            margin: 2px;
            box-sizing: border-box;
        }
        #pairOptions {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            margin: 10px 0;
        }
        #pairOptions .dice-option {
            width: calc(16.666% - 4px);
            margin: 2px;
            box-sizing: border-box;
        }
        #sizeOptions, #quadOptions {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin: 10px 0;
        }
        #sizeOptions .dice-option {
            width: calc(25% - 4px);
            margin: 2px;
            box-sizing: border-box;
        }
        #tripleOptions, #allTripleOptions {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin: 10px 0;
        }
        .select-all-btn {
            margin: 5px 0 5px 5px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            background-color: #00bbd4;
            color: white;
            border: none;
            border-radius: 5px;
        }
        .select-all-btn:hover {
            background-color: #0095a8;
        }
        .stats-container {
            overflow: hidden;
            position: relative;
        }
        .stats-slider {
            display: flex;
            transition: transform 0.3s ease;
            width: 400%;
        }
        .stats-slide {
            width: 25%;
            flex-shrink: 0;
            padding: 0 10px;
            box-sizing: border-box;
        }
        .stats-nav {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
        }
        .stats-nav-btn {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ccc;
            margin: 0 4px;
            cursor: pointer;
        }
        .stats-nav-btn.active {
            background-color: #00bbd4;
        }
        .record-number {
            color: #999;
            font-size: 10px;
            margin-left: 0px;
        }
    </style>
</head>
<body>
    <div class="left-container">
        <div class="stats-container">
            <div class="stats-nav">
                <div class="stats-nav-btn active" data-slide="0"></div>
                <div class="stats-nav-btn" data-slide="1"></div>
                <div class="stats-nav-btn" data-slide="2"></div>
                <div class="stats-nav-btn" data-slide="3"></div>
                <div class="stats-nav-btn" data-slide="4"></div>
            </div>
            <div class="stats-slider" id="statsSlider">
                <div class="stats-slide">
                    <h3>最近10次类型出现次数</h3>
                    <div class="stats-grid2" id="typeStatsGrid"></div>
                </div>
                <div class="stats-slide">
                    <h3>最近2次未出现的点数</h3>
                    <div class="stats-item" id="missingStatsGrid"></div>
                </div>
                <div class="stats-slide">
                    <h3>最近10次结果统计</h3>
                    <div class="stats-grid" id="statsGrid"></div>
                </div>                
                <div class="stats-slide">
                    <h3>连续N次未出现</h3>
                    <div class="stats-grid" id="continuousMissingStatsGrid"></div>
                </div>
                <div class="stats-slide">
                    <h3>双型连续N次未出现</h3>
                    <div class="stats-grid" id="doubleTypeMissingStatsGrid"></div>
                </div>
            </div>
        </div>
        <div class="balance-container">
            <div class="balance-info">
                <span>剩余金额：</span>
                <div id="balanceAmount">10000</div>
                <button id="betButton">下注</button>
            </div>
            <div id="betInfo">
                <div id="betPointsInfo"></div>
                <div id="betSizeInfo"></div>
                <div id="betQuadInfo"></div>
                <div id="betDoubleInfo"></div>
                <div id="betSingleInfo"></div>
                <div id="betPairInfo"></div>
                <div id="betTripleInfo"></div>
                <div id="betAllTripleInfo"></div>
                <div id="betTotalResultInfo"></div>
            </div>
        </div>
        <div id="betModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <div class="modal-body">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>选择下注点数</h3>
                        <div>
                            <button class="select-all-btn" onclick="selectAll('pointOptions')">全选</button>
                        </div>
                    </div>                    
                    <div class="dice-options" id="pointOptions">
                        <div class="dice-option" data-value="1">1</div>
                        <div class="dice-option" data-value="2">2</div>
                        <div class="dice-option" data-value="3">3</div>
                        <div class="dice-option" data-value="4">4</div>
                        <div class="dice-option" data-value="5">5</div>
                        <div class="dice-option" data-value="6">6</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>选择下注大小</h3>
                        <div>
                            <button class="select-all-btn" onclick="selectAll('sizeOptions')">全选</button>
                        </div>
                    </div>
                    <div class="dice-options" id="sizeOptions">
                        <div class="dice-option" data-value="大">大</div>
                        <div class="dice-option" data-value="小">小</div>
                        <div class="dice-option" data-value="单">单</div>
                        <div class="dice-option" data-value="双">双</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3>选择下注四联</h3>
                        <div>
                            <button class="select-all-btn" onclick="selectAll('quadOptions')">全选</button>
                        </div>
                    </div>
                    <div class="dice-options" id="quadOptions">
                        <div class="dice-option" data-value="6543">6543</div>
                        <div class="dice-option" data-value="6532">6532</div>
                        <div class="dice-option" data-value="5432">5432</div>
                        <div class="dice-option" data-value="4321">4321</div>
                    </div>                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div><h3 style="margin: 0;">选择下注双型</h3>                        
                            <button class="select-all-btn" onclick="selectAllBySize('doubleOptions', 'small')">全选小</button>
                            <button class="select-all-btn" onclick="selectAllBySize('doubleOptions', 'big')">全选大</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(1)">全选1</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(2)">全选2</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(3)">全选3</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(4)">全选4</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(5)">全选5</button>
                            <button class="select-all-btn" onclick="selectDoubleByNumber(6)">全选6</button>
                        </div>
                    </div>
                    <div class="dice-options" id="doubleOptions">
                        <div class="dice-option" data-value="112">112</div>
                        <div class="dice-option" data-value="113">113</div>
                        <div class="dice-option" data-value="114">114</div>
                        <div class="dice-option" data-value="115">115</div>
                        <div class="dice-option" data-value="116">116</div>
                        <div class="dice-option" data-value="221">221</div>
                        <div class="dice-option" data-value="223">223</div>
                        <div class="dice-option" data-value="224">224</div>
                        <div class="dice-option" data-value="225">225</div>
                        <div class="dice-option" data-value="226">226</div>
                        <div class="dice-option" data-value="331">331</div>
                        <div class="dice-option" data-value="332">332</div>
                        <div class="dice-option" data-value="334">334</div>
                        <div class="dice-option" data-value="335">335</div>
                        <div class="dice-option" data-value="336">336</div>
                        <div class="dice-option" data-value="441">441</div>
                        <div class="dice-option" data-value="442">442</div>
                        <div class="dice-option" data-value="443">443</div>
                        <div class="dice-option" data-value="445">445</div>
                        <div class="dice-option" data-value="446">446</div>
                        <div class="dice-option" data-value="551">551</div>
                        <div class="dice-option" data-value="552">552</div>
                        <div class="dice-option" data-value="553">553</div>
                        <div class="dice-option" data-value="554">554</div>
                        <div class="dice-option" data-value="556">556</div>
                        <div class="dice-option" data-value="661">661</div>
                        <div class="dice-option" data-value="662">662</div>
                        <div class="dice-option" data-value="663">663</div>
                        <div class="dice-option" data-value="664">664</div>
                        <div class="dice-option" data-value="665">665</div>
                    </div>                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <div><h3 style="margin: 0;">选择下注单型</h3>                        
                            <button class="select-all-btn" onclick="selectAllBySize('singleOptions', 'small')">全选小</button>
                            <button class="select-all-btn" onclick="selectAllBySize('singleOptions', 'big')">全选大</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(1)">全选1</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(2)">全选2</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(3)">全选3</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(4)">全选4</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(5)">全选5</button>
                            <button class="select-all-btn" onclick="selectSingleByNumber(6)">全选6</button>
                            <button class="select-all-btn" onclick="selectSiLian()">单四</button>
                            <button class="select-all-btn" onclick="selectPureSingle()">纯单</button>
                            <button class="select-all-btn" onclick="filterBySize('singleOptions', 'small')">筛选小</button>
                            <button class="select-all-btn" onclick="filterBySize('singleOptions', 'big')">筛选大</button>
                        </div>
                    </div>
                    <div class="dice-options" id="singleOptions">
                        <div class="dice-option" data-value="126">126</div>
                        <div class="dice-option" data-value="135">135</div>
                        <div class="dice-option" data-value="234">234</div>
                        <div class="dice-option" data-value="256">256</div>
                        <div class="dice-option" data-value="346">346</div>
                        <div class="dice-option" data-value="123">123</div>
                        <div class="dice-option" data-value="136">136</div>
                        <div class="dice-option" data-value="145">145</div>
                        <div class="dice-option" data-value="235">235</div>
                        <div class="dice-option" data-value="356">356</div>
                        <div class="dice-option" data-value="124">124</div>
                        <div class="dice-option" data-value="146">146</div>
                        <div class="dice-option" data-value="236">236</div>
                        <div class="dice-option" data-value="246">246</div>
                        <div class="dice-option" data-value="456">456</div>
                        <div class="dice-option" data-value="125">125</div>
                        <div class="dice-option" data-value="134">134</div>
                        <div class="dice-option" data-value="156">156</div>
                        <div class="dice-option" data-value="245">245</div>
                        <div class="dice-option" data-value="345">345</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3 style="margin: 0;">选择下注对子</h3>
                        <div>
                            <button class="select-all-btn" onclick="selectAll('pairOptions')">全选</button>
                        </div>
                    </div>
                    <div class="dice-options" id="pairOptions">
                        <div class="dice-option" data-value="11">11</div>
                        <div class="dice-option" data-value="22">22</div>
                        <div class="dice-option" data-value="33">33</div>
                        <div class="dice-option" data-value="44">44</div>
                        <div class="dice-option" data-value="55">55</div>
                        <div class="dice-option" data-value="66">66</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3 style="margin: 0;">选择下注围骰</h3>
                        <div>
                            <button class="select-all-btn" onclick="selectAll('tripleOptions')">全选</button>
                        </div>
                    </div>
                    <div class="dice-options" id="tripleOptions">
                        <div class="dice-option" data-value="111">111</div>
                        <div class="dice-option" data-value="222">222</div>
                        <div class="dice-option" data-value="333">333</div>
                        <div class="dice-option" data-value="444">444</div>
                        <div class="dice-option" data-value="555">555</div>
                        <div class="dice-option" data-value="666">666</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h3 style="margin: 0;">选择下注全围</h3>
                    </div>
                    <div class="dice-options" id="allTripleOptions">
                        <div class="dice-option" data-value="allTriple">全围</div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="confirmBet">确定</button>
                    <button id="cancelBet">取消</button>
                </div>
            </div>
        </div>
        <div class="dice-container">
            <div class="dice" id="dice1">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
            <div class="dice" id="dice2">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
            <div class="dice" id="dice3">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
        </div>
        <div class="auto-roll-container">
            <label>
                <input type="checkbox" id="autoRollCheckbox"> 自动摇
            </label>
            <input type="number" id="autoRollCount" min="1" value="1" disabled>
            次
        </div>
    </div>
    <button id="rollButton" onclick="playAudio()">开始摇骰子</button>
    </div>
    <div class="right-container">
        <div class="record-container" id="recordContainer">
        </div>		
		<button id="muteButton" style="position: fixed; top: 10px; left: 98%; transform: translateX(-50%); z-index: 1000; background-color: #f0f0f0; border: none; padding: 5px 8px; border-radius: 5px;">🔊 静音</button>
		</div>
	</div>
	
    <script>
        // 游戏变量声明
        const dice1 = document.getElementById('dice1');
        const dice2 = document.getElementById('dice2');
        const dice3 = document.getElementById('dice3');
        const rollButton = document.getElementById('rollButton');
        const recordContainer = document.getElementById('recordContainer');
        const statsGrid = document.getElementById('statsGrid');
        const autoRollCheckbox = document.getElementById('autoRollCheckbox');
        const autoRollCountInput = document.getElementById('autoRollCount');
        let autoRollInterval = null;
        let remainingRolls = 0;

        // 下注相关变量
        let betPoints = [];
        let betSizes = [];
        let betQuads = [];
        let betDoubles = [];
        let betSingles = [];
        let betPairs = [];
        let betTriples = [];
        let betAllTriples = [];
        let betAmount = 0;
        
        // 选择状态变量
        let selectedDice = [];
        let selectedSizes = [];
        let selectedQuads = [];
        let selectedDoubles = [];
        let selectedSingles = [];
        let selectedPairs = [];
        let selectedTriples = [];
        let selectedAllTriples = [];

        // 音频控制
        const audio = new Audio('dice-roll.mp3');
        let isMuted = false;
        const muteButton = document.getElementById('muteButton');
        
        // 骰子功能函数
        function rollDice() {
            return Math.floor(Math.random() * 6) + 1;
        }

        function updateDice(diceElement, value) {
            const faces = diceElement.querySelectorAll('.face');
            faces[0].textContent = value;
            faces[1].textContent = 7 - value;
            faces[2].textContent = value === 2 ? 3 : value === 5 ? 4 : value;
            faces[3].textContent = value === 3 ? 4 : value === 4 ? 3 : value;
            faces[4].textContent = value === 6 ? 2 : value === 1 ? 5 : value;
            faces[5].textContent = value === 1 ? 5 : value === 6 ? 2 : value;
        }

        // 游戏逻辑函数
        function getSize(sum) {
            return sum > 10 ? '大' : '小';
        }
        
        function getOddEven(sum) {
            return sum % 2 === 1 ? '单' : '双';
        }

        function isTriple(dice1, dice2, dice3) {
            return dice1 === dice2 && dice2 === dice3;
        }
        
        function isPair(dice1, dice2, dice3) {
            return (dice1 === dice2) || (dice1 === dice3) || (dice2 === dice3);
        }
        
        function getPairValue(dice1, dice2, dice3) {
            if (dice1 === dice2) return dice1;
            if (dice1 === dice3) return dice1;
            if (dice2 === dice3) return dice2;
            return null;
        }

        function getDiceType(dice1, dice2, dice3) {
            const counts = {};
            counts[dice1] = (counts[dice1] || 0) + 1;
            counts[dice2] = (counts[dice2] || 0) + 1;
            counts[dice3] = (counts[dice3] || 0) + 1;
            
            const values = Object.values(counts);
            
            if (values.includes(3)) {
                return ''; // 三个相同不显示类型
            } else if (values.includes(2)) {
                return '双型'; // 有两个相同
            } else {
                // 判断是否为单四（检查是否属于四联选项）
                const uniqueValues = [...new Set([dice1, dice2, dice3])].sort();
                
                // 四联选项的数字组合
                const siLianGroups = [
                    [1, 2, 3], // 123组合
                    [2, 3, 4], // 234组合
                    [3, 4, 5], // 345组合
                    [4, 5, 6], // 456组合
                    [1, 2, 4], // 456组合
                    [1, 3, 4], // 456组合
                    [2, 3, 5], // 456组合
                    [2, 4, 5], // 456组合
                    [2, 3, 6], // 456组合
                    [2, 5, 6], // 456组合
                    [3, 5, 6], // 456组合
                    [3, 4, 6], // 456组合
                ];
                
                // 检查当前点数是否是任一四联组合的子集
                const isSiLian = siLianGroups.some(group => {
                    return uniqueValues.every(val => group.includes(val));
                });
                
                return isSiLian ? '单四' : '纯单';
            }
        }
        
        // 记录和统计功能
        function saveRecord(record) {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            record.oddEven = getOddEven(record.sum);
            record.diceType = getDiceType(record.dice1, record.dice2, record.dice3);
            records.push(record);
            
            // 限制最大记录数为1000条
            if (records.length > 1000) {
                records = records.slice(-1000);
            }
            
            localStorage.setItem('diceRecords', JSON.stringify(records));
        }

        function displayRecords() {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            recordContainer.innerHTML = '';
            
            // 保持原始顺序（最新记录在最下方）
            records.forEach((record, index) => {
                const sortedDice = [record.dice1, record.dice2, record.dice3].sort((a, b) => a - b);
                const recordItem = document.createElement('div');
                recordItem.className = `record-item ${record.isTriple ? 'green' : record.size === '大' ? 'red' : 'yellow'}`;
                
                // 计算期数序号（从1开始）
                const recordNumber = records.length - index;
                
                if (record.isTriple) {
                    recordItem.innerHTML = `${sortedDice[0]}${sortedDice[1]}${sortedDice[2]} <span class="record-number">#${recordNumber}</span>`;
                } else {
                    recordItem.innerHTML = `${sortedDice[0]}${sortedDice[1]}${sortedDice[2]} ${record.sum} ${record.size} ${record.oddEven} ${record.diceType} <span class="record-number">#${recordNumber}</span>`;
                }
                    
                recordContainer.appendChild(recordItem);
            });
            
            // 滚动到底部显示最新记录
            recordContainer.scrollTop = recordContainer.scrollHeight;
        }
        
        function updateStats() {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            const recentRecords = records.slice(-100);
            
            // 类型统计
            const typeCounts = {
                '双型': 0,
                '单四': 0,
                '纯单': 0,
                '围骰': 0
            };
            
            recentRecords.forEach(record => {
                const diceType = getDiceType(record.dice1, record.dice2, record.dice3);
                if (record.isTriple) {
                    typeCounts['围骰']++;
                } else if (diceType === '双型') {
                    typeCounts['双型']++;
                } else if (diceType === '单四') {
                    typeCounts['单四']++;
                } else if (diceType === '纯单') {
                    typeCounts['纯单']++;
                }
            });
            
            document.getElementById('typeStatsGrid').innerHTML = `
                <div class="stats-item">双型: ${typeCounts['双型']}</div>
                <div class="stats-item">单四: ${typeCounts['单四']}</div>
                <div class="stats-item">纯单: ${typeCounts['纯单']}</div>
                <div class="stats-item">围骰: ${typeCounts['围骰']}</div>
            `;
            
            const count = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };

            recentRecords.forEach(record => {
                count[record.dice1]++;
                count[record.dice2]++;
                count[record.dice3]++;
            });

            statsGrid.innerHTML = `
                <div class="stats-item">1️⃣: ${count[1]}</div>
                <div class="stats-item">2️⃣: ${count[2]}</div>
                <div class="stats-item">3️⃣: ${count[3]}</div>
                <div class="stats-item">4️⃣: ${count[4]}</div>
                <div class="stats-item">5️⃣: ${count[5]}</div>
                <div class="stats-item">6️⃣: ${count[6]}</div>
            `;
            
            const lastTwoRecords = records.slice(-2);
            const appearedNumbers = new Set();
            lastTwoRecords.forEach(record => {
                appearedNumbers.add(record.dice1);
                appearedNumbers.add(record.dice2);
                appearedNumbers.add(record.dice3);
            });

            const allNumbers = new Set([1, 2, 3, 4, 5, 6]);
            const missingNumbers = [...allNumbers].filter(num => !appearedNumbers.has(num));

            document.getElementById('missingStatsGrid').innerHTML = `
                <div class="missing-numbers">
                    ${missingNumbers.join('  ')}
                </div>
            `;

            const continuousMissingCounts = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };

            for (let num = 1; num <= 6; num++) {
                let continuousCount = 0;
                for (let i = recentRecords.length - 1; i >= 0; i--) {
                    const record = recentRecords[i];
                    const currentNumbers = new Set([record.dice1, record.dice2, record.dice3]);

                    if (!currentNumbers.has(num)) {
                        continuousCount++;
                    } else {
                        break;
                    }
                }
                continuousMissingCounts[num] = continuousCount;
            }

            document.getElementById('continuousMissingStatsGrid').innerHTML = `
                <div class="stats-item">1️⃣: ${continuousMissingCounts[1]}</div>
                <div class="stats-item">2️⃣: ${continuousMissingCounts[2]}</div>
                <div class="stats-item">3️⃣: ${continuousMissingCounts[3]}</div>
                <div class="stats-item">4️⃣: ${continuousMissingCounts[4]}</div>
                <div class="stats-item">5️⃣: ${continuousMissingCounts[5]}</div>
                <div class="stats-item">6️⃣: ${continuousMissingCounts[6]}</div>
            `;
            
            const doubleTypeMissingCounts = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };
            for (let num = 1; num <= 6; num++) {
                let found = false;
                let count = 0;
                for (let i = records.length - 1; i >= 0; i--) {
                    const record = records[i];
                    const diceValues = [record.dice1, record.dice2, record.dice3];
                    
                    const countNum = diceValues.filter(v => v === num).length;
                    const isCurrentNumDoubleType = countNum === 2;
                    
                    if (isCurrentNumDoubleType) {
                        found = true;
                        break;
                    }
                    count++;
                }
                doubleTypeMissingCounts[num] = found ? count : records.length;
            }
            
            document.getElementById('doubleTypeMissingStatsGrid').innerHTML = `
                <div class="stats-item">1️⃣: ${doubleTypeMissingCounts[1]}</div>
                <div class="stats-item">2️⃣: ${doubleTypeMissingCounts[2]}</div>
                <div class="stats-item">3️⃣: ${doubleTypeMissingCounts[3]}</div>
                <div class="stats-item">4️⃣: ${doubleTypeMissingCounts[4]}</div>
                <div class="stats-item">5️⃣: ${doubleTypeMissingCounts[5]}</div>
                <div class="stats-item">6️⃣: ${doubleTypeMissingCounts[6]}</div>
            `;
        }

        // 下注选择功能
        function selectDoubleByNumber(number) {
            const options = document.querySelectorAll('#doubleOptions .dice-option');
            const targetNumber = number.toString();
            
            let allSelected = true;
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (value.split(targetNumber).length-1 >= 2 && !selectedDoubles.includes(value)) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (value.split(targetNumber).length-1 >= 2) {
                    if (allSelected) {
                        option.classList.remove('selected');
                        selectedDoubles = selectedDoubles.filter(item => item !== value);
                    } else if (!selectedDoubles.includes(value)) {
                        option.classList.add('selected');
                        selectedDoubles.push(value);
                    }
                }
            });
        }

        function selectSingleByNumber(number) {
            const options = document.querySelectorAll('#singleOptions .dice-option');
            const targetNumber = number.toString();
            
            let allSelected = true;
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (value.includes(targetNumber) && !selectedSingles.includes(value)) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (value.includes(targetNumber)) {
                    if (allSelected) {
                        option.classList.remove('selected');
                        selectedSingles = selectedSingles.filter(item => item !== value);
                    } else if (!selectedSingles.includes(value)) {
                        option.classList.add('selected');
                        selectedSingles.push(value);
                    }
                }
            });
        }

        function selectSiLian() {
            const siLianGroups = ['123','124','134','234','235','245','345','256','236','356','346','456'];
            const options = document.querySelectorAll('#singleOptions .dice-option');
            
            let allSelected = true;
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (siLianGroups.includes(value) && !selectedSingles.includes(value)) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (siLianGroups.includes(value)) {
                    if (allSelected) {
                        option.classList.remove('selected');
                        selectedSingles = selectedSingles.filter(item => item !== value);
                    } else if (!selectedSingles.includes(value)) {
                        option.classList.add('selected');
                        selectedSingles.push(value);
                    }
                }
            });
        }
        
        function selectPureSingle() {
            const siLianGroups = ['123','124','134','234','235','245','345','256','236','356','346','456'];
            const options = document.querySelectorAll('#singleOptions .dice-option');
            
            let allSelected = true;
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (!siLianGroups.includes(value) && !selectedSingles.includes(value)) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                if (!siLianGroups.includes(value)) {
                    if (allSelected) {
                        option.classList.remove('selected');
                        selectedSingles = selectedSingles.filter(item => item !== value);
                    } else if (!selectedSingles.includes(value)) {
                        option.classList.add('selected');
                        selectedSingles.push(value);
                    }
                }
            });
        }

        function selectAllBySize(optionType, sizeType) {
            const options = document.querySelectorAll(`#${optionType} .dice-option`);
            let selectedArray = optionType === 'doubleOptions' ? selectedDoubles : selectedSingles;
            
            let allSelected = true;
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                const sum = value.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                const shouldBeSelected = (sizeType === 'big' && sum > 10) || (sizeType === 'small' && sum <= 10);
                
                if (shouldBeSelected && !selectedArray.includes(value)) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                const sum = value.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                const shouldBeSelected = (sizeType === 'big' && sum > 10) || (sizeType === 'small' && sum <= 10);
                
                if (shouldBeSelected) {
                    if (allSelected) {
                        option.classList.remove('selected');
                        if (optionType === 'doubleOptions') {
                            selectedDoubles = selectedDoubles.filter(item => item !== value);
                        } else {
                            selectedSingles = selectedSingles.filter(item => item !== value);
                        }
                    } else {
                        option.classList.add('selected');
                        if (optionType === 'doubleOptions' && !selectedDoubles.includes(value)) {
                            selectedDoubles.push(value);
                        } else if (optionType === 'singleOptions' && !selectedSingles.includes(value)) {
                            selectedSingles.push(value);
                        }
                    }
                }
            });
        }

        function filterBySize(optionType, sizeType) {
            const options = document.querySelectorAll(`#${optionType} .dice-option`);
            let selectedArray = optionType === 'doubleOptions' ? selectedDoubles : selectedSingles;
            
            // 先取消所有选项的选中状态
            options.forEach(option => {
                option.classList.remove('selected');
            });
            
            // 根据大小筛选并选中符合条件的选项
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                const sum = value.split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
                const shouldBeSelected = (sizeType === 'big' && sum > 10) || (sizeType === 'small' && sum <= 10);
                
                if (shouldBeSelected && selectedArray.includes(value)) {
                    option.classList.add('selected');
                } else {
                    // 从选中数组中移除不符合条件的选项
                    if (optionType === 'doubleOptions') {
                        selectedDoubles = selectedDoubles.filter(item => item !== value);
                    } else {
                        selectedSingles = selectedSingles.filter(item => item !== value);
                    }
                }
            });
        }
        
        function selectAll(optionType) {
            const options = document.querySelectorAll(`#${optionType} .dice-option`);
            
            let allSelected = true;
            options.forEach(option => {
                if (!option.classList.contains('selected')) {
                    allSelected = false;
                }
            });
            
            options.forEach(option => {
                const value = option.getAttribute('data-value');
                
                if (allSelected) {
                    option.classList.remove('selected');
                    if (optionType === 'pointOptions') selectedDice = [];
                    else if (optionType === 'sizeOptions') selectedSizes = [];
                    else if (optionType === 'quadOptions') selectedQuads = [];
                    else if (optionType === 'pairOptions') selectedPairs = [];
                    else if (optionType === 'tripleOptions') selectedTriples = [];
                    else if (optionType === 'allTripleOptions') selectedAllTriples = [];
                } else {
                    option.classList.add('selected');
                    if (optionType === 'pointOptions' && !selectedDice.includes(value)) 
                        selectedDice.push(value);
                    else if (optionType === 'sizeOptions' && !selectedSizes.includes(value)) 
                        selectedSizes.push(value);
                    else if (optionType === 'quadOptions' && !selectedQuads.includes(value)) 
                        selectedQuads.push(value);
                    else if (optionType === 'pairOptions' && !selectedPairs.includes(value)) 
                        selectedPairs.push(value);
                    else if (optionType === 'tripleOptions' && !selectedTriples.includes(value)) 
                        selectedTriples.push(value);
                    else if (optionType === 'allTripleOptions' && !selectedAllTriples.includes(value)) 
                        selectedAllTriples.push(value);
                }
            });
        }

        function resetPointOptions() {
            document.querySelectorAll('#pointOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedDice = [];
        }

        function resetSizeOptions() {
            document.querySelectorAll('#sizeOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedSizes = [];
        }
        
        function resetQuadOptions() {
            document.querySelectorAll('#quadOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedQuads = [];
        }

        function resetDoubleOptions() {
            document.querySelectorAll('#doubleOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedDoubles = [];
        }

        function resetSingleOptions() {
            document.querySelectorAll('#singleOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedSingles = [];
        }
        
        function resetPairOptions() {
            document.querySelectorAll('#pairOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedPairs = [];
        }
        
        function resetTripleOptions() {
            document.querySelectorAll('#tripleOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedTriples = [];
        }
        
        function resetAllTripleOptions() {
            document.querySelectorAll('#allTripleOptions .dice-option').forEach(option => {
                option.classList.remove('selected');
            });
            selectedAllTriples = [];
        }

        function resetDiceOptions() {
            resetPointOptions();
            resetSizeOptions();
            resetQuadOptions();
            resetDoubleOptions();
            resetSingleOptions();
            resetPairOptions();
            resetTripleOptions();
            resetAllTripleOptions();
        }

        function rollOnce() {
            rollButton.disabled = true;
            dice1.style.animation = 'roll 3s infinite';
            dice2.style.animation = 'roll 3s infinite';
            dice3.style.animation = 'roll 3s infinite';

            setTimeout(() => {
                const value1 = rollDice();
                const value2 = rollDice();
                const value3 = rollDice();
                const sum = value1 + value2 + value3;
                const isTripleResult = isTriple(value1, value2, value3);
                const isPairResult = isPair(value1, value2, value3);
                const pairValue = isPairResult ? getPairValue(value1, value2, value3) : null;
                
                let sizeResult = '';
                let oddEvenResult = '';
                if (!isTripleResult) {
                    sizeResult = getSize(sum);
                    oddEvenResult = getOddEven(sum);
                }

                updateDice(dice1, value1);
                updateDice(dice2, value2);
                updateDice(dice3, value3);

                dice1.style.animation = '';
                dice2.style.animation = '';
                dice3.style.animation = '';

                const record = {
                    dice1: value1,
                    dice2: value2,
                    dice3: value3,
                    sum: sum,
                    size: sizeResult,
                    isTriple: isTripleResult
                };
                saveRecord(record);
                displayRecords();
                updateStats();
                
                if (betPoints.length === 0 && betSizes.length === 0 && betQuads.length === 0 && 
                    betDoubles.length === 0 && betSingles.length === 0 && betPairs.length === 0 && 
                    betTriples.length === 0 && betAllTriples.length === 0) {
                    
                    document.getElementById('betPointsInfo').textContent = '';
                    document.getElementById('betSizeInfo').textContent = '';
                    document.getElementById('betQuadInfo').textContent = '';
                    document.getElementById('betDoubleInfo').textContent = '';
                    document.getElementById('betSingleInfo').textContent = '';
                    document.getElementById('betPairInfo').textContent = '';
                    document.getElementById('betTripleInfo').textContent = '';
                    document.getElementById('betAllTripleInfo').textContent = '';
                    document.getElementById('betTotalResultInfo').textContent = '';
                } else {
                    const currentBalance = parseInt(document.getElementById('balanceAmount').textContent, 10);
                    let totalWinnings = 0;
                    let totalReturn = 0;
                    let totalProfit = 0;
                    let totalCost = 0;

                    // 单点下注结算
                    let pointsWinnings = 0;
                    let pointsReturn = 0;
                    if (betPoints.length > 0) {
                        const diceResults = [value1, value2, value3];
                        const pointCost = betPoints.length * 100;
                        totalCost += pointCost;

                        betPoints.forEach(point => {
                            const count = diceResults.filter(result => result === parseInt(point, 10)).length;
                            if (count === 1) {
                                pointsWinnings += 200;
                                pointsReturn += 100;
                            } else if (count === 2) {
                                pointsWinnings += 300;
                                pointsReturn += 100;
                            } else if (count === 3) {
                                pointsWinnings += 400;
                                pointsReturn += 100;
                            }
                        });

                        document.getElementById('betPointsInfo').textContent = 
                            `单点下注: ${betPoints.join(', ')}, 花费: -${pointCost}` + 
                            (pointsWinnings > 0 ? `, 收回: +${pointsReturn}, 盈利: +${pointsWinnings - pointsReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += pointsWinnings;
                        totalReturn += pointsReturn;
                    }

                    // 大小单双下注结算
                    let sizeWinnings = 0;
                    let sizeReturn = 0;
                    if (betSizes.length > 0 && !isTripleResult) {
                        const sizeCost = betSizes.length * 300;
                        totalCost += sizeCost;

                        betSizes.forEach(size => {
                            if (size === sizeResult || size === oddEvenResult) {
                                sizeWinnings += 600;
                                sizeReturn += 300;
                            }
                        });

                        document.getElementById('betSizeInfo').textContent = 
                            `大小单双下注: ${betSizes.join(', ')}, 花费: -${sizeCost}` + 
                            (sizeWinnings > 0 ? `, 收回: +${sizeReturn}, 盈利: +${sizeWinnings - sizeReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += sizeWinnings;
                        totalReturn += sizeReturn;
                    } else if (betSizes.length > 0 && isTripleResult) {
                        const sizeCost = betSizes.length * 300;
                        totalCost += sizeCost;
                        document.getElementById('betSizeInfo').textContent = 
                            `大小单双下注: ${betSizes.join(', ')}, 花费: -${sizeCost}, 豹子通吃, 收回: +0, 盈利: +0`;
                    }

                    // 四联下注结算
                    let quadWinnings = 0;
                    let quadReturn = 0;
                    if (betQuads.length > 0) {
                        const quadCost = betQuads.length * 100;
                        totalCost += quadCost;

                        betQuads.forEach(quad => {
                            const quadNumbers = quad.split('').map(Number);
                            const diceResults = [value1, value2, value3];
                            const hasDuplicates = new Set(diceResults).size !== diceResults.length;
                            
                            if (!hasDuplicates) {
                                const isQuadWin = diceResults.every(result => quadNumbers.includes(result));
                                if (isQuadWin) {
                                    quadWinnings += 800;
                                    quadReturn += 100;
                                }
                            }
                        });

                        document.getElementById('betQuadInfo').textContent = 
                            `四联下注: ${betQuads.join(', ')}, 花费: -${quadCost}` + 
                            (quadWinnings > 0 ? `, 收回: +${quadReturn}, 盈利: +${quadWinnings - quadReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += quadWinnings;
                        totalReturn += quadReturn;
                    }

                    // 双型下注结算
                    let doubleWinnings = 0;
                    let doubleReturn = 0;
                    if (betDoubles.length > 0) {
                        const doubleCost = betDoubles.length * 100;
                        totalCost += doubleCost;
                        
                        const diceResults = [value1, value2, value3].sort().join('');
                        
                        betDoubles.forEach(double => {
                            const betDoubleSorted = double.split('').sort().join('');
                            if (diceResults === betDoubleSorted) {
                                doubleWinnings += 5100;
                                doubleReturn += 100;
                            }
                        });

                        document.getElementById('betDoubleInfo').textContent = 
                            `双型下注: ${betDoubles.join(', ')}, 花费: -${doubleCost}` + 
                            (doubleWinnings > 0 ? `, 收回: +${doubleReturn}, 盈利: +${doubleWinnings - doubleReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += doubleWinnings;
                        totalReturn += doubleReturn;
                    }

                    // 单型下注结算
                    let singleWinnings = 0;
                    let singleReturn = 0;
                    if (betSingles.length > 0) {
                        const singleCost = betSingles.length * 100;
                        totalCost += singleCost;
                        const diceResults = [value1, value2, value3].sort().join('');

                        betSingles.forEach(single => {
                            if (diceResults === single) {
                                singleWinnings += 3100;
                                singleReturn += 100;
                            }
                        });

                        document.getElementById('betSingleInfo').textContent = 
                            `单型下注: ${betSingles.join(', ')}, 花费: -${singleCost}` + 
                            (singleWinnings > 0 ? `, 收回: +${singleReturn}, 盈利: +${singleWinnings - singleReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += singleWinnings;
                        totalReturn += singleReturn;
                    }
                    
                    // 对子下注结算
                    let pairWinnings = 0;
                    let pairReturn = 0;
                    if (betPairs.length > 0 && isPairResult && !isTripleResult) {
                        const pairCost = betPairs.length * 100;
                        totalCost += pairCost;
                        
                        betPairs.forEach(pair => {
                            if (pairValue && pair === pairValue.toString() + pairValue.toString()) {
                                pairWinnings += 900;
                                pairReturn += 100;
                            }
                        });
                        
                        document.getElementById('betPairInfo').textContent = 
                            `对子下注: ${betPairs.join(', ')}, 花费: -${pairCost}` + 
                            (pairWinnings > 0 ? `, 收回: +${pairReturn}, 盈利: +${pairWinnings - pairReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += pairWinnings;
                        totalReturn += pairReturn;
                    } else if (betPairs.length > 0) {
                        const pairCost = betPairs.length * 100;
                        totalCost += pairCost;
                        document.getElementById('betPairInfo').textContent = 
                            `对子下注: ${betPairs.join(', ')}, 花费: -${pairCost}, 收回: +0, 盈利: +0`;
                    }
                    
                    // 围骰下注结算
                    let tripleWinnings = 0;
                    let tripleReturn = 0;
                    if (betTriples.length > 0 && isTripleResult) {
                        const tripleCost = betTriples.length * 100;
                        totalCost += tripleCost;
                        const diceResult = value1.toString().repeat(3);
                        
                        betTriples.forEach(triple => {
                            if (triple === diceResult) {
                                tripleWinnings += 15100;
                                tripleReturn += 100;
                            }
                        });
                        
                        document.getElementById('betTripleInfo').textContent = 
                            `围骰下注: ${betTriples.join(', ')}, 花费: -${tripleCost}` + 
                            (tripleWinnings > 0 ? `, 收回: +${tripleReturn}, 盈利: +${tripleWinnings - tripleReturn}` : `, 收回: +0, 盈利: +0`);
                        totalWinnings += tripleWinnings;
                        totalReturn += tripleReturn;
                    } else if (betTriples.length > 0) {
                        const tripleCost = betTriples.length * 100;
                        totalCost += tripleCost;
                        document.getElementById('betTripleInfo').textContent = 
                            `围骰下注: ${betTriples.join(', ')}, 花费: -${tripleCost}, 收回: +0, 盈利: +0`;
                    }
                    
                    // 全围下注结算
                    let allTripleWinnings = 0;
                    let allTripleReturn = 0;
                    if (betAllTriples.length > 0 && isTripleResult) {
                        const allTripleCost = betAllTriples.length * 100;
                        totalCost += allTripleCost;
                        
                        allTripleWinnings += 2500;
                        allTripleReturn += 100;
                        
                        document.getElementById('betAllTripleInfo').textContent = 
                            `全围下注: ${betAllTriples.join(', ')}, 花费: -${allTripleCost}` + 
                            `, 收回: +${allTripleReturn}, 盈利: +${allTripleWinnings - allTripleReturn}`;
                        totalWinnings += allTripleWinnings;
                        totalReturn += allTripleReturn;
                    } else if (betAllTriples.length > 0) {
                        const allTripleCost = betAllTriples.length * 100;
                        totalCost += allTripleCost;
                        document.getElementById('betAllTripleInfo').textContent = 
                            `全围下注: ${betAllTriples.join(', ')}, 花费: -${allTripleCost}, 收回: +0, 盈利: +0`;
                    }

                    totalProfit = (totalReturn + (totalWinnings - totalReturn)) - totalCost;

                    document.getElementById('balanceAmount').textContent = currentBalance + totalReturn + (totalWinnings - totalReturn);

                    document.getElementById('betTotalResultInfo').textContent = 
                        `总花费: -${totalCost} | 总收回: +${totalReturn} | 总盈利: +${totalWinnings - totalReturn} | 净利: ${totalProfit >= 0 ? '+' + totalProfit : totalProfit}`;

                    // 清空下注
                    betPoints = [];
                    betSizes = [];
                    betQuads = [];
                    betDoubles = [];
                    betSingles = [];
                    betPairs = [];
                    betTriples = [];
                    betAllTriples = [];
                    betAmount = 0;
                }

                if (autoRollCheckbox.checked && remainingRolls > 0) {
                    remainingRolls--;
                    autoRollCountInput.value = remainingRolls;
                    if (remainingRolls > 0) {
                        setTimeout(() => {
                            rollButton.click();
                        }, 500);
                    } else {
                        autoRollCheckbox.checked = false;
                        autoRollCountInput.disabled = true;
                    }
                }

                rollButton.disabled = false;
            }, 3000);
        }

        // 事件监听器
        rollButton.addEventListener('click', () => {
            if (autoRollCheckbox.checked) {
                const count = parseInt(autoRollCountInput.value, 10);
                if (count > 0) {
                    remainingRolls = count;
                    autoRollCountInput.disabled = true;
                    rollOnce();
                }
            } else {
                rollOnce();
            }
        });

        autoRollCheckbox.addEventListener('change', () => {
            autoRollCountInput.disabled = !autoRollCheckbox.checked;
        });

        muteButton.addEventListener('click', () => {
            isMuted = !isMuted;
            muteButton.textContent = isMuted ? "🔇 取消静音" : "🔊 静音";
        });

        function playAudio() {
            if (!isMuted) {
                audio.play();
            }
        }

        // 下注模态框相关
        const pointOptions = document.querySelectorAll('#pointOptions .dice-option');
        const sizeOptions = document.querySelectorAll('#sizeOptions .dice-option');
        const quadOptions = document.querySelectorAll('#quadOptions .dice-option');
        const doubleOptions = document.querySelectorAll('#doubleOptions .dice-option');
        const singleOptions = document.querySelectorAll('#singleOptions .dice-option');
        const pairOptions = document.querySelectorAll('#pairOptions .dice-option');
        const tripleOptions = document.querySelectorAll('#tripleOptions .dice-option');
        const allTripleOptions = document.querySelectorAll('#allTripleOptions .dice-option');
        const confirmBetButton = document.getElementById('confirmBet');
        const cancelBetButton = document.getElementById('cancelBet');
        const betModal = document.getElementById('betModal');
        const closeModal = document.querySelector('.close');
        const balanceAmount = document.getElementById('balanceAmount');

        // 点数选择
        pointOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedDice.includes(value)) {
                    selectedDice = selectedDice.filter(dice => dice !== value);
                    option.classList.remove('selected');
                } else {
                    selectedDice.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // 大小选择
        sizeOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedSizes.includes(value)) {
                    selectedSizes = selectedSizes.filter(size => size !== value);
                    option.classList.remove('selected');
                } else {
                    selectedSizes.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // 四联选择
        quadOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedQuads.includes(value)) {
                    selectedQuads = selectedQuads.filter(quad => quad !== value);
                    option.classList.remove('selected');
                } else {
                    selectedQuads.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // 双型选择
        doubleOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedDoubles.includes(value)) {
                    selectedDoubles = selectedDoubles.filter(double => double !== value);
                    option.classList.remove('selected');
                } else {
                    selectedDoubles.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // 单型选择
        singleOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedSingles.includes(value)) {
                    selectedSingles = selectedSingles.filter(single => single !== value);
                    option.classList.remove('selected');
                } else {
                    selectedSingles.push(value);
                    option.classList.add('selected');
                }
            });
        });
        
        // 对子选择
        pairOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedPairs.includes(value)) {
                    selectedPairs = selectedPairs.filter(pair => pair !== value);
                    option.classList.remove('selected');
                } else {
                    selectedPairs.push(value);
                    option.classList.add('selected');
                }
            });
        });
        
        // 围骰选择
        tripleOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedTriples.includes(value)) {
                    selectedTriples = selectedTriples.filter(triple => triple !== value);
                    option.classList.remove('selected');
                } else {
                    selectedTriples.push(value);
                    option.classList.add('selected');
                }
            });
        });
        
        // 全围选择
        allTripleOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');
                if (selectedAllTriples.includes(value)) {
                    selectedAllTriples = selectedAllTriples.filter(allTriple => allTriple !== value);
                    option.classList.remove('selected');
                } else {
                    selectedAllTriples.push(value);
                    option.classList.add('selected');
                }
            });
        });

        //点击下注
        betButton.addEventListener('click', () => {
			if (betPoints.length > 0 || betSizes.length > 0 || betQuads.length > 0 || betDoubles.length > 0 || betSingles.length > 0 || betPairs.length > 0 || betTriples.length > 0 || betAllTriples.length > 0) {
				const currentBalance = parseInt(balanceAmount.textContent, 10);
				balanceAmount.textContent = currentBalance + betAmount;

				betPoints = [];
				betSizes = [];
				betQuads = [];
				betDoubles = [];
				betSingles = [];
				betPairs = [];
				betTriples = [];
				betAllTriples = [];
				betAmount = 0;

				document.getElementById('betPointsInfo').textContent = '';
				document.getElementById('betSizeInfo').textContent = '';
				document.getElementById('betQuadInfo').textContent = '';
				document.getElementById('betDoubleInfo').textContent = '';
				document.getElementById('betSingleInfo').textContent = '';
				document.getElementById('betPairInfo').textContent = '';
				document.getElementById('betTripleInfo').textContent = '';
				document.getElementById('betAllTripleInfo').textContent = '';
				document.getElementById('betTotalResultInfo').textContent = '';
			}

			selectedDice = [];
			selectedSizes = [];
			selectedQuads = [];
			selectedDoubles = [];
			selectedSingles = [];
			selectedPairs = [];
			selectedTriples = [];
			selectedAllTriples = [];
			resetDiceOptions();
			betModal.style.display = 'block';
		});

        closeModal.addEventListener('click', () => {
            betModal.style.display = 'none';
        });

        cancelBetButton.addEventListener('click', () => {
            betModal.style.display = 'none';
        });
        
        // 确认下注
        confirmBetButton.addEventListener('click', () => {
            if (selectedDice.length > 0 || selectedSizes.length > 0 || selectedQuads.length > 0 || 
                selectedDoubles.length > 0 || selectedSingles.length > 0 || selectedPairs.length > 0 || 
                selectedTriples.length > 0 || selectedAllTriples.length > 0) {
                
                const pointCost = selectedDice.length * 100;
                const sizeCost = selectedSizes.length * 300;
                const quadCost = selectedQuads.length * 100;
                const doubleCost = selectedDoubles.length * 100;
                const singleCost = selectedSingles.length * 100;
                const pairCost = selectedPairs.length * 100;
                const tripleCost = selectedTriples.length * 100;
                const allTripleCost = selectedAllTriples.length * 100;
                const totalCost = pointCost + sizeCost + quadCost + doubleCost + singleCost + pairCost + tripleCost + allTripleCost;

                const currentBalance = parseInt(balanceAmount.textContent, 10);

                if (currentBalance >= totalCost) {
                    // 更新下注信息显示
                    if (selectedDice.length > 0) {
                        document.getElementById('betPointsInfo').textContent = `单点下注: ${selectedDice.join(', ')}, 花费: -${pointCost}`;
                    } else {
                        document.getElementById('betPointsInfo').textContent = '';
                    }

                    if (selectedSizes.length > 0) {
                        document.getElementById('betSizeInfo').textContent = `大小下注: ${selectedSizes.join(', ')}, 花费: -${sizeCost}`;
                    } else {
                        document.getElementById('betSizeInfo').textContent = '';
                    }

                    if (selectedQuads.length > 0) {
                        document.getElementById('betQuadInfo').textContent = `四联下注: ${selectedQuads.join(', ')}, 花费: -${quadCost}`;
                    } else {
                        document.getElementById('betQuadInfo').textContent = '';
                    }

                    if (selectedDoubles.length > 0) {
                        document.getElementById('betDoubleInfo').textContent = `双型下注: ${selectedDoubles.join(', ')}, 花费: -${doubleCost}`;
                    } else {
                        document.getElementById('betDoubleInfo').textContent = '';
                    }

                    if (selectedSingles.length > 0) {
                        document.getElementById('betSingleInfo').textContent = `单型下注: ${selectedSingles.join(', ')}, 花费: -${singleCost}`;
                    } else {
                        document.getElementById('betSingleInfo').textContent = '';
                    }
                    
                    if (selectedPairs.length > 0) {
                        document.getElementById('betPairInfo').textContent = `对子下注: ${selectedPairs.join(', ')}, 花费: -${pairCost}`;
                    } else {
                        document.getElementById('betPairInfo').textContent = '';
                    }
                    
                    if (selectedTriples.length > 0) {
                        document.getElementById('betTripleInfo').textContent = `围骰下注: ${selectedTriples.join(', ')}, 花费: -${tripleCost}`;
                    } else {
                        document.getElementById('betTripleInfo').textContent = '';
                    }
                    
                    if (selectedAllTriples.length > 0) {
                        document.getElementById('betAllTripleInfo').textContent = `全围下注: ${selectedAllTriples.join(', ')}, 花费: -${allTripleCost}`;
                    } else {
                        document.getElementById('betAllTripleInfo').textContent = '';
                    }

                    document.getElementById('betTotalResultInfo').textContent = '';

                    // 更新下注数据
                    betPoints = selectedDice;
                    betSizes = selectedSizes;
                    betQuads = selectedQuads;
                    betDoubles = selectedDoubles;
                    betSingles = selectedSingles;
                    betPairs = selectedPairs;
                    betTriples = selectedTriples;
                    betAllTriples = selectedAllTriples;
                    betAmount = totalCost;

                    // 更新余额
                    balanceAmount.textContent = currentBalance - totalCost;

                    // 关闭模态框
                    betModal.style.display = 'none';

                    // 重置选择状态
                    selectedDice = [];
                    selectedSizes = [];
                    selectedQuads = [];
                    selectedDoubles = [];
                    selectedSingles = [];
                    selectedPairs = [];
                    selectedTriples = [];
                    selectedAllTriples = [];
                    resetDiceOptions();
                } else {
                    if (confirm('余额不足！是否重置金额为10000？')) {
                        balanceAmount.textContent = 10000;
                    }
                }
            } else {
                alert('请选择至少一个点数、大小、四联、双型、单型、对子、围骰或全围！');
            }
        });

        // 取消下注
        cancelBetButton.addEventListener('click', () => {
            betModal.style.display = 'none';
            resetDiceOptions();
            selectedDice = [];
            selectedSizes = [];
            selectedQuads = [];
            selectedDoubles = [];
            selectedSingles = [];
            selectedPairs = [];
            selectedTriples = [];
            selectedAllTriples = [];
        });

        // 关闭模态框
        closeModal.addEventListener('click', () => {
            betModal.style.display = 'none';
            resetDiceOptions();
            selectedDice = [];
            selectedSizes = [];
            selectedQuads = [];
            selectedDoubles = [];
            selectedSingles = [];
            selectedPairs = [];
            selectedTriples = [];
            selectedAllTriples = [];
        });

        // 统计滑动功能
        let currentSlide = 0;
        const statsSlider = document.getElementById('statsSlider');
        const navButtons = document.querySelectorAll('.stats-nav-btn');

        function goToSlide(index) {
            if (index < 0) {
                index = 4;
            } else if (index > 4) {
                index = 0;
            }
            
            currentSlide = index;
            statsSlider.style.transform = `translateX(-${currentSlide * 25}%)`;
            
            navButtons.forEach((btn, i) => {
                btn.classList.toggle('active', i === currentSlide);
            });
        }

        navButtons.forEach((btn, index) => {
            btn.addEventListener('click', () => goToSlide(index));
        });

        const statsContainer = document.querySelector('.stats-container');

        let touchStartX = 0;
        let touchEndX = 0;
        let isSwiping = false;

        statsContainer.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            isSwiping = true;
        }, { passive: true });

        statsContainer.addEventListener('touchmove', (e) => {
            if (!isSwiping) return;
            e.preventDefault();
        }, { passive: false });

        statsContainer.addEventListener('touchend', (e) => {
            if (!isSwiping) return;
            isSwiping = false;
            touchEndX = e.changedTouches[0].clientX;
            handleSwipe();
        }, { passive: true });

        function handleSwipe() {
            const threshold = 30;
            
            if (touchStartX - touchEndX > threshold) {
                goToSlide(currentSlide + 1);
            } else if (touchEndX - touchStartX > threshold) {
                goToSlide(currentSlide - 1);
            }
        }

        // 初始化
        displayRecords();
        updateStats();
    </script>
</body>
</html>
