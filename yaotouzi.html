<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‘‡éª°å­æ¸¸æˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        .left-container {
            width: 70%;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #fff;
            padding-bottom: 0px; /* ä¸ºæŒ‰é’®ç•™å‡ºç©ºé—´ */
        }
        .stats-container {
            width: 100%;
            height: auto;
            padding: 10px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            border-bottom: 2px solid #ccc;
        }
        .stats-container h3 {
            text-align: center;
            margin: 0 0 10px 0;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            text-align: center;
        }
        .stats-item {
            font-size: 20px;
        }
        .balance-container {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            background-color: #f9f9f9;
            border-bottom: 2px solid #ccc;
            display: flex;
            flex-direction: column; /* å‚ç›´æ’åˆ— */
            gap: 5px; /* è®¾ç½®è¡Œé—´è· */
        }
        .balance-info {
            display: flex;
            align-items: center; /* å‰©ä½™é‡‘é¢å’Œä¸‹æ³¨æŒ‰é’®æ°´å¹³å¯¹é½ */
            gap: 10px; /* è®¾ç½®é—´è· */
        }

        .balance-container span {
            font-size: 14px;
            font-weight: normal;
        }

        #balanceAmount {
            color: #00bbd4;
            font-size: 18px;
            font-weight: lighter;
        }
        .dice-container {
            width: 100%;
            height: auto;
            display: grid; /* ä½¿ç”¨ grid å¸ƒå±€ */
            grid-template-areas: "dice1 dice1 dice1"
                                "dice2 . dice3";
            grid-template-columns: 60px 20px; /* è®¾ç½®ä¸¤åˆ—å¸ƒå±€ */
            grid-template-rows: 60px 70px 0px; /* è®¾ç½®è‡ªåŠ¨è¡Œé«˜ */
            justify-content: center;
            align-items: center;
            gap: 0px; /* è®¾ç½®éª°å­ä¹‹é—´çš„é—´è· */
            perspective: 1000px;
            margin-bottom: 10px; /* ä¸è‡ªåŠ¨æ‘‡éª°å­å¤é€‰æ¡†çš„è·ç¦» */
            position: fixed; /* å›ºå®šå®šä½ */
            bottom: 100px; /* è·ç¦»é¡µé¢åº•éƒ¨ 80pxï¼ˆæŒ‰é’®é«˜åº¦ 60px + 10px é—´è·ï¼‰ */
            left: 30%; /* æ°´å¹³å±…ä¸­ */
            transform: translateX(-50%); /* æ°´å¹³å±…ä¸­ */
            z-index: 1000; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        }
        .auto-roll-container {
            margin-top: 10px; /* ä¸éª°å­çš„è·ç¦» */
            display: flex;
            align-items: center;
            gap: 10px;
            position: fixed; /* å›ºå®šå®šä½ */
            bottom: 80px; /* è·ç¦»é¡µé¢åº•éƒ¨ 60pxï¼ˆæŒ‰é’®é«˜åº¦ 60pxï¼‰ */
            left: 30%; /* æ°´å¹³å±…ä¸­ */
            transform: translateX(-50%); /* æ°´å¹³å±…ä¸­ */
            z-index: 1000; /* ç¡®ä¿åœ¨æœ€ä¸Šå±‚ */
        }
        .auto-roll-container input[type="number"] {
            width: 60px;
            padding: 5px;
            font-size: 16px;
        }
        
        .dice {
            width: 42px;
            height: 42px;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(0deg) rotateY(0deg);
            background-color: white;
            margin: 10px;
        }
        
        #dice1 {
            grid-area: dice1; /* è®¾ç½®éª°å­1çš„ä½ç½® */
            justify-self: center; /* ä½¿éª°å­1é ä¸­ */
        }
        
        #dice2 {
            grid-area: dice2; /* è®¾ç½®éª°å­2çš„ä½ç½® */
            justify-self: end; /* ä½¿éª°å­2é å³ */
        }
        
        #dice3 {
            grid-area: dice3; /* è®¾ç½®éª°å­3çš„ä½ç½® */
            justify-self: start; /* ä½¿éª°å­3é å·¦ */
        }
        
        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            grid-column: span 3; /* æŒ‰é’®è·¨ä¸¤åˆ— */
            justify-self: center;
        }
        .dice .face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #00bbd4;
            border: 0px solid #ccc;
            border-radius: 0px;
            font-size: 20px;
            font-weight: bold;
            color: white;
        }
        .dice .front { transform: translateZ(21px); }
        .dice .back { transform: rotateY(180deg) translateZ(21px); }
        .dice .left { transform: rotateY(-90deg) translateZ(21px); }
        .dice .right { transform: rotateY(90deg) translateZ(21px); }
        .dice .top { transform: rotateX(90deg) translateZ(21px); }
        .dice .bottom { transform: rotateX(-90deg) translateZ(21px); }

        @keyframes roll {
            0% { transform: rotateX(0deg) rotateY(0deg); }
            100% { transform: rotateX(720deg) rotateY(720deg); }

        }
        .right-container {
            width: 50%;
            height: 100vh;
            background-color: black;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            box-sizing: border-box;
        }
        .record-container {
            width: 100%;
            height: calc(100vh - 60px);
            overflow-y: auto; /* åªå¢åŠ ç«–å‘æ»šåŠ¨æ¡ */
            font-size: 24px;  /* ä¿æŒåŸæ¥çš„å­—ä½“å¤§å° */
        }
        .record-item {
            margin-bottom: 10px;
            padding: 5px;
        }
        .record-item.red { color: red; }
        .record-item.yellow { color: yellow; }
        .record-item.green { color: green; }
        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        .dice-image {
            width: 30px;
            height: 30px;
        }
        
        #rollButton {
            position: fixed; /* å›ºå®šåœ¨é¡µé¢åº•éƒ¨ */
            bottom: 5px; /* è·ç¦»é¡µé¢åº•éƒ¨ 20px */
            left: 30%; /* æ°´å¹³å±…ä¸­ */
            transform: translateX(-50%); /* æ°´å¹³å±…ä¸­ */
            width: 140px; /* æŒ‰é’®å®½åº¦ */
            height: 60px; /* æŒ‰é’®é«˜åº¦ */
            border-radius: 100px; /* åœ†è§’ */
            background-color: rgb(255, 193, 7); /* æŒ‰é’®èƒŒæ™¯è‰² */
            font-size: 16px; /* å­—ä½“å¤§å° */
            cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆæ ·å¼ */
            z-index: 1000; /* ç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚ */
        }
        /* ä¸‹æ³¨æŒ‰é’®æ ·å¼ */
        #betButton {
            margin-left: 5px;
            margin-top: 0px;
            padding: 5px 10px;
            font-size: 12px;
            cursor: pointer;
            background-color: #00bbd4;
            color: white;
            border: none;
            border-radius: 5px;
        }

        /* å¼¹çª—æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            text-align: center;
            border-radius: 10px;
        }
        
        /* å¼¹çª—æ ‡é¢˜æ ·å¼ */
        .modal-content h3 {
            font-size: 16px; /* å­—ä½“å¤§å°è®¾ç½®ä¸º 14px */
            font-weight: normal /* å­—ä½“ç²—ç»†è®¾ç½®ä¸º light */
            margin: 10px 0; /* è°ƒæ•´æ ‡é¢˜çš„ä¸Šä¸‹é—´è· */
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .dice-options {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .dice-option {
            width: 40px;
            height: 40px;
            line-height: 40px;
            text-align: center;
            background-color: white;
            border: 2px solid #00bbd4;
            color: black;
            border-radius: 5px;
            cursor: pointer;
        }

        .dice-option.selected {
            background-color: #00bbd4;
            color: #fff;
        }

        #confirmBet, #cancelBet {
            margin: 20px;
            padding: 10px 30px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
        }

        #confirmBet {
            background-color: #00bbd4;
            color: white;
        }

        #cancelBet {
            color: black;
        }
        #balanceAmount {
            color: #00bbd4; /* é‡‘é¢æ•°å­—çš„é¢œè‰² */
            font-size: 20px; /* å­—ä½“å¤§å° */
            font-weight: bold; /* å­—ä½“åŠ ç²— */
        }

        /* ä¸‹æ³¨ä¿¡æ¯æ ·å¼ */
        #betInfo {
            display: flex;
            flex-direction: column;
            gap: 8px; /* è®¾ç½®è¡Œé—´è· */
            font-size: 14px;
            color: black;
            text-align: left; /* é å·¦å¯¹é½ */
        }
		/* é˜²æ­¢æŒ‰é’®è¢«é€‰ä¸­ */
		#rollButton {
			user-select: none;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
}
    </style>
</head>
<body>
    <div class="left-container">
        <div class="stats-container">
            <h3>æœ€è¿‘10æ¬¡ç»“æœç»Ÿè®¡</h3>
            <div class="stats-grid" id="statsGrid">
                <!-- ç»Ÿè®¡ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
            </div>
        </div>
        <div class="balance-container">
            <div class="balance-info">
                <span>å‰©ä½™é‡‘é¢ï¼š</span>
                <div id="balanceAmount">2000</div>
                <button id="betButton">ä¸‹æ³¨</button>
            </div>
            <div id="betInfo">
                <div id="betPointsInfo"></div> <!-- ç‚¹æ•°ä¸‹æ³¨ä¿¡æ¯ -->
                <div id="betSizeInfo"></div>   <!-- å¤§å°ä¸‹æ³¨ä¿¡æ¯ -->
                <div id="betQuadInfo"></div>   <!-- å››è”ä¸‹æ³¨ä¿¡æ¯ -->
                <div id="betTotalResultInfo"></div> <!-- æ€»çš„è¾“èµ¢ç»“æœ -->
            </div>
        </div>
        
        <!-- å¼¹çª—ç»“æ„ -->
        <!-- åœ¨å¼¹çª—ç»“æ„ä¸­å¢åŠ å››è”é€‰é¡¹ -->
        <div id="betModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>é€‰æ‹©ä¸‹æ³¨ç‚¹æ•°</h3>
                <div class="dice-options" id="pointOptions">
                    <div class="dice-option" data-value="1">1</div>
                    <div class="dice-option" data-value="2">2</div>
                    <div class="dice-option" data-value="3">3</div>
                    <div class="dice-option" data-value="4">4</div>
                    <div class="dice-option" data-value="5">5</div>
                    <div class="dice-option" data-value="6">6</div>
                </div>
                <h3>é€‰æ‹©ä¸‹æ³¨å¤§å°</h3>
                <div class="dice-options" id="sizeOptions">
                    <div class="dice-option" data-value="å¤§">å¤§</div>
                    <div class="dice-option" data-value="å°">å°</div>
                </div>
                <h3>é€‰æ‹©ä¸‹æ³¨å››è”</h3>
                <div class="dice-options" id="quadOptions">
                    <div class="dice-option" data-value="6543">6543</div>
                    <div class="dice-option" data-value="6532">6532</div>
                    <div class="dice-option" data-value="5432">5432</div>
                    <div class="dice-option" data-value="4321">4321</div>
                </div>
                <button id="confirmBet">ç¡®å®š</button>
                <button id="cancelBet">å–æ¶ˆ</button>
            </div>
        </div>
        <div class="dice-container">
            <div class="dice" id="dice1">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
            <div class="dice" id="dice2">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
            <div class="dice" id="dice3">
                <div class="face front">1</div>
                <div class="face back">6</div>
                <div class="face left">4</div>
                <div class="face right">3</div>
                <div class="face top">2</div>
                <div class="face bottom">5</div>
            </div>
        </div>
        <div class="auto-roll-container">
            <label>
                <input type="checkbox" id="autoRollCheckbox"> è‡ªåŠ¨æ‘‡
            </label>
            <input type="number" id="autoRollCount" min="1" value="1" disabled>
            æ¬¡
        </div>
    </div>
    <button id="rollButton" onclick="playAudio()">å¼€å§‹æ‘‡éª°å­</button>
    </div>
    <div class="right-container">
        <div class="record-container" id="recordContainer">
            <!-- è®°å½•å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
        </div>		
		<button id="muteButton" style="position: fixed; top: 10px; left: 99%; transform: translateX(-50%); z-index: 1000; background-color: #f0f0f0; border: none; padding: 5px 10px; border-radius: 5px;">ğŸ”Š é™éŸ³</button>
		</div>
	</div>
	
    <script>
        const dice1 = document.getElementById('dice1');
        const dice2 = document.getElementById('dice2');
        const dice3 = document.getElementById('dice3');
        const rollButton = document.getElementById('rollButton');
        const recordContainer = document.getElementById('recordContainer');
        const statsGrid = document.getElementById('statsGrid');
        const autoRollCheckbox = document.getElementById('autoRollCheckbox');
        const autoRollCountInput = document.getElementById('autoRollCount');
        let autoRollInterval = null;
        let remainingRolls = 0; // å‰©ä½™è‡ªåŠ¨æ‘‡éª°å­æ¬¡æ•°

        // æ·»åŠ å…¨å±€å˜é‡è®°å½•ä¸‹æ³¨ä¿¡æ¯
        let betPoints = []; // è®°å½•ä¸‹æ³¨çš„ç‚¹æ•°
        let betSizes = [];  // è®°å½•ä¸‹æ³¨çš„å¤§å°ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
        let betQuads = [];  // è®°å½•ä¸‹æ³¨çš„å››è”ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
        let betAmount = 0;  // è®°å½•ä¸‹æ³¨çš„é‡‘é¢

        // åˆ›å»ºAudioå¯¹è±¡
        const audio = new Audio('dice-roll.mp3');
		
		let isMuted = false;
		const muteButton = document.getElementById('muteButton');
		
		// é™éŸ³æŒ‰é’®ç‚¹å‡»äº‹ä»¶
		muteButton.addEventListener('click', () => {
			isMuted = !isMuted;
			muteButton.textContent = isMuted ? "ğŸ”‡ å–æ¶ˆé™éŸ³" : "ğŸ”Š é™éŸ³";
		});

        function playAudio() {
			if (!isMuted) {
				audio.play();
			}
		}

        function rollDice() {
            return Math.floor(Math.random() * 6) + 1;
        }
    
        function updateDice(diceElement, value) {
            const faces = diceElement.querySelectorAll('.face');
            
            // æ›´æ–°æ¯ä¸€é¢çš„æ•°å­—
            faces[0].textContent = value; // å‰é¢
            faces[1].textContent = 7 - value; // åé¢ï¼ˆéª°å­å¯¹é¢ä¹‹å’Œä¸º7ï¼‰
            faces[2].textContent = value === 2 ? 3 : value === 5 ? 4 : value; // å·¦é¢
            faces[3].textContent = value === 3 ? 4 : value === 4 ? 3 : value; // å³é¢
            faces[4].textContent = value === 6 ? 2 : value === 1 ? 5 : value; // ä¸Šé¢
            faces[5].textContent = value === 1 ? 5 : value === 6 ? 2 : value; // ä¸‹é¢
        }
    
        function getSize(sum) {
            return sum > 10 ? 'å¤§' : 'å°';
        }
    
        function isTriple(dice1, dice2, dice3) {
            return dice1 === dice2 && dice2 === dice3;
        }
    
        function saveRecord(record) {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            records.push(record);
            localStorage.setItem('diceRecords', JSON.stringify(records));
        }
    
        function displayRecords() {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            recordContainer.innerHTML = '';
            records.slice(-10).forEach((record) => {
                const sortedDice = [record.dice1, record.dice2, record.dice3].sort((a, b) => a - b);
                const recordItem = document.createElement('div');
                recordItem.className = `record-item ${record.isTriple ? 'green' : record.size === 'å¤§' ? 'red' : 'yellow'}`;
                
                if (record.isTriple) {
                    // å¦‚æœæ˜¯ä¸‰ä¸ªç›¸åŒçš„ç‚¹æ•°ï¼Œåªæ˜¾ç¤ºç‚¹æ•°
                    recordItem.textContent = `${sortedDice[0]}${sortedDice[1]}${sortedDice[2]}`;
                } else {
                    // å¦åˆ™æ˜¾ç¤ºç‚¹æ•°ã€å’Œä¸å¤§å°
                    recordItem.textContent = `${sortedDice[0]}${sortedDice[1]}${sortedDice[2]}    ${record.sum}    ${record.size}`;
                }
                
                recordContainer.appendChild(recordItem);
            });
            recordContainer.scrollTop = recordContainer.scrollHeight;
        }
    
        function updateStats() {
            let records = JSON.parse(localStorage.getItem('diceRecords')) || [];
            const recentRecords = records.slice(-10);
            const count = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };

            recentRecords.forEach(record => {
                count[record.dice1]++;
                count[record.dice2]++;
                count[record.dice3]++;
            });

            statsGrid.innerHTML = `
                <div class="stats-item">1ï¸âƒ£: ${count[1]}</div>
                <div class="stats-item">2ï¸âƒ£: ${count[2]}</div>
                <div class="stats-item">3ï¸âƒ£: ${count[3]}</div>
                <div class="stats-item">4ï¸âƒ£: ${count[4]}</div>
                <div class="stats-item">5ï¸âƒ£: ${count[5]}</div>
                <div class="stats-item">6ï¸âƒ£: ${count[6]}</div>
            `;
        }

        // å½“å¤é€‰æ¡†çŠ¶æ€æ”¹å˜æ—¶ï¼Œå¯ç”¨æˆ–ç¦ç”¨è¾“å…¥æ¡†
        autoRollCheckbox.addEventListener('change', () => {
            autoRollCountInput.disabled = !autoRollCheckbox.checked;
        });

        // å•æ¬¡ä¸‹æ³¨
		function rollOnce() {
			rollButton.disabled = true;
			dice1.style.animation = 'roll 3s infinite';
			dice2.style.animation = 'roll 3s infinite';
			dice3.style.animation = 'roll 3s infinite';

			setTimeout(() => {
				// ç”Ÿæˆéšæœºéª°å­ç»“æœ
				const value1 = rollDice();
				const value2 = rollDice();
				const value3 = rollDice();
				const sum = value1 + value2 + value3;
				const sizeResult = getSize(sum);
				const isTripleResult = isTriple(value1, value2, value3);

				// æ›´æ–°éª°å­æ˜¾ç¤º
				updateDice(dice1, value1);
				updateDice(dice2, value2);
				updateDice(dice3, value3);

				// åœæ­¢åŠ¨ç”»
				dice1.style.animation = '';
				dice2.style.animation = '';
				dice3.style.animation = '';

				// ä¿å­˜è®°å½•
				const record = {
					dice1: value1,
					dice2: value2,
					dice3: value3,
					sum: sum,
					size: sizeResult,
					isTriple: isTripleResult
				};
				saveRecord(record);
				displayRecords();
				updateStats();
				
				rollButton.style.userSelect = 'none';
				rollButton.style.webkitUserSelect = 'none';
				rollButton.style.msUserSelect = 'none';

				// æ£€æŸ¥æ˜¯å¦æœ‰ä¸‹æ³¨
				if (betPoints.length === 0 && betSizes.length === 0 && betQuads.length === 0) {
					document.getElementById('betPointsInfo').textContent = '';
					document.getElementById('betSizeInfo').textContent = '';
					document.getElementById('betQuadInfo').textContent = '';
					document.getElementById('betTotalResultInfo').textContent = '';
				} else {
					const currentBalance = parseInt(balanceAmount.textContent, 10);
					let totalWinnings = 0;  // æ€»ç›ˆåˆ©ï¼ˆåŒ…å«æœ¬é‡‘ï¼‰
					let totalReturn = 0;    // æ€»æ”¶å›æœ¬é‡‘
					let totalProfit = 0;    // æ€»å‡€ç›ˆåˆ©ï¼ˆç›ˆåˆ©éƒ¨åˆ†ï¼‰
					let totalCost = 0;     // æ€»ä¸‹æ³¨èŠ±è´¹

					// å•ç‚¹ä¸‹æ³¨è®¡ç®—
					let pointsWinnings = 0;
					let pointsReturn = 0;
					if (betPoints.length > 0) {
						const diceResults = [value1, value2, value3];
						const pointCost = betPoints.length * 100;
						totalCost += pointCost;

						betPoints.forEach(point => {
							const count = diceResults.filter(result => result === parseInt(point, 10)).length;
							if (count === 1) {
								pointsWinnings += 200; // æœ¬é‡‘100 + ç›ˆåˆ©100
								pointsReturn += 100;
							} else if (count === 2) {
								pointsWinnings += 300; // æœ¬é‡‘100 + ç›ˆåˆ©200
								pointsReturn += 100;
							} else if (count === 3) {
								pointsWinnings += 400; // æœ¬é‡‘100 + ç›ˆåˆ©300
								pointsReturn += 100;
							}
						});

						document.getElementById('betPointsInfo').textContent = 
							`å•ç‚¹ä¸‹æ³¨: ${betPoints.join(', ')}, èŠ±è´¹: -${pointCost}` + 
							(pointsWinnings > 0 ? `, æ”¶å›: +${pointsReturn}, ç›ˆåˆ©: +${pointsWinnings - pointsReturn}` : `, æ”¶å›: +0, ç›ˆåˆ©: +0`);
						totalWinnings += pointsWinnings;
						totalReturn += pointsReturn;
					}

					// å¤§å°ä¸‹æ³¨è®¡ç®—
					let sizeWinnings = 0;
					let sizeReturn = 0;
					if (betSizes.length > 0) {
						const sizeCost = betSizes.length * 300;
						totalCost += sizeCost;

						betSizes.forEach(size => {
							if (size === sizeResult) {
								sizeWinnings += 600; // æœ¬é‡‘300 + ç›ˆåˆ©300
								sizeReturn += 300;
							}
						});

						document.getElementById('betSizeInfo').textContent = 
							`å¤§å°ä¸‹æ³¨: ${betSizes.join(', ')}, èŠ±è´¹: -${sizeCost}` + 
							(sizeWinnings > 0 ? `, æ”¶å›: +${sizeReturn}, ç›ˆåˆ©: +${sizeWinnings - sizeReturn}` : `, æ”¶å›: +0, ç›ˆåˆ©: +0`);
						totalWinnings += sizeWinnings;
						totalReturn += sizeReturn;
					}

					// å››è”ä¸‹æ³¨è®¡ç®—
					let quadWinnings = 0;
					let quadReturn = 0;
					if (betQuads.length > 0) {
						const quadCost = betQuads.length * 100;
						totalCost += quadCost;

						betQuads.forEach(quad => {
							const quadNumbers = quad.split('').map(Number);
							const diceResults = [value1, value2, value3];
							const hasDuplicates = new Set(diceResults).size !== diceResults.length;
							
							if (!hasDuplicates) {
								const isQuadWin = diceResults.every(result => quadNumbers.includes(result));
								if (isQuadWin) {
									quadWinnings += 800; // æœ¬é‡‘100 + ç›ˆåˆ©700
									quadReturn += 100;
								}
							}
						});

						document.getElementById('betQuadInfo').textContent = 
							`å››è”ä¸‹æ³¨: ${betQuads.join(', ')}, èŠ±è´¹: -${quadCost}` + 
							(quadWinnings > 0 ? `, æ”¶å›: +${quadReturn}, ç›ˆåˆ©: +${quadWinnings - quadReturn}` : `, æ”¶å›: +0, ç›ˆåˆ©: +0`);
						totalWinnings += quadWinnings;
						totalReturn += quadReturn;
					}

					// è®¡ç®—å‡€ç›ˆåˆ©ï¼ˆæ€»æ”¶å› + æ€»ç›ˆåˆ© - æ€»èŠ±è´¹ï¼‰
					totalProfit = (totalReturn + (totalWinnings - totalReturn)) - totalCost;

					// æ›´æ–°ä½™é¢ï¼ˆå½“å‰ä½™é¢ + æ€»æ”¶å› + æ€»ç›ˆåˆ©ï¼‰
					balanceAmount.textContent = currentBalance + totalReturn + (totalWinnings - totalReturn);

					// æ˜¾ç¤ºæ€»ç»“æœ
					document.getElementById('betTotalResultInfo').textContent = 
						`æ€»èŠ±è´¹: -${totalCost} | æ€»æ”¶å›: +${totalReturn} | æ€»ç›ˆåˆ©: +${totalWinnings - totalReturn} | å‡€åˆ©: ${totalProfit >= 0 ? '+' + totalProfit : totalProfit}`;

					// æ¸…ç©ºä¸‹æ³¨ä¿¡æ¯
					betPoints = [];
					betSizes = [];
					betQuads = [];
					betAmount = 0;
				}

				// è‡ªåŠ¨ä¸‹æ³¨é€»è¾‘
				if (autoRollCheckbox.checked && remainingRolls > 0) {
					remainingRolls--;
					autoRollCountInput.value = remainingRolls;
					if (remainingRolls > 0) {
						setTimeout(() => {
							rollButton.click();
						}, 500);
					} else {
						autoRollCheckbox.checked = false;
						autoRollCountInput.disabled = true;
					}
				}

				rollButton.disabled = false;
			}, 3000);
		}

        // ä¿®æ”¹ rollButton çš„ç‚¹å‡»äº‹ä»¶
        rollButton.addEventListener('click', () => {
            if (autoRollCheckbox.checked) {
                const count = parseInt(autoRollCountInput.value, 10);
                if (count > 0) {
                    remainingRolls = count; // è®¾ç½®å‰©ä½™æ¬¡æ•°
                    autoRollCountInput.disabled = true; // ç¦ç”¨è¾“å…¥æ¡†
                    rollOnce(); // å¼€å§‹ç¬¬ä¸€æ¬¡æ‘‡éª°å­
                }
            } else {
                rollOnce(); // æ‰‹åŠ¨æ‘‡éª°å­
            }
        });
    
        displayRecords();
        updateStats();
        // è·å–å…ƒç´ 
        const pointOptions = document.querySelectorAll('#pointOptions .dice-option');
        const sizeOptions = document.querySelectorAll('#sizeOptions .dice-option');
        const confirmBetButton = document.getElementById('confirmBet');
        const cancelBetButton = document.getElementById('cancelBet');
        const betModal = document.getElementById('betModal');
        const closeModal = document.querySelector('.close');
        const balanceAmount = document.getElementById('balanceAmount');
        const betInfo = document.getElementById('betInfo');
        
        // è·å–å››è”é€‰é¡¹
        const quadOptions = document.querySelectorAll('#quadOptions .dice-option');

        // è®°å½•é€‰æ‹©çš„å››è”
        let selectedQuads = []; // æ”¯æŒå¤šé€‰

        // é€‰æ‹©å››è”
        quadOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');

                // åˆ‡æ¢å››è”é€‰æ‹©
                if (selectedQuads.includes(value)) {
                    selectedQuads = selectedQuads.filter(quad => quad !== value);
                    option.classList.remove('selected');
                } else {
                    selectedQuads.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // è®°å½•é€‰æ‹©çš„ç‚¹æ•°å’Œå¤§å°
        let selectedDice = [];
        let selectedSizes = []; // æ”¯æŒå¤šé€‰

        // æ‰“å¼€å¼¹çª—
		betButton.addEventListener('click', () => {
			// æ£€æŸ¥æ˜¯å¦æœ‰æœªç»“ç®—çš„ä¸‹æ³¨ä¿¡æ¯
			if (betPoints.length > 0 || betSizes.length > 0 || betQuads.length > 0) {
				// å¦‚æœæœ‰æœªç»“ç®—çš„ä¸‹æ³¨ä¿¡æ¯ï¼Œæ¸…ç©ºä¸‹æ³¨ä¿¡æ¯å¹¶è¿”è¿˜é‡‘é¢
				const currentBalance = parseInt(balanceAmount.textContent, 10);
				balanceAmount.textContent = currentBalance + betAmount; // è¿”è¿˜å·²æ‰£é™¤çš„é‡‘é¢

				// æ¸…ç©ºä¸‹æ³¨ä¿¡æ¯
				betPoints = [];
				betSizes = [];
				betQuads = [];
				betAmount = 0;

				// æ¸…ç©ºä¸‹æ³¨ä¿¡æ¯æ˜¾ç¤º
				document.getElementById('betPointsInfo').textContent = '';
				document.getElementById('betSizeInfo').textContent = '';
				document.getElementById('betQuadInfo').textContent = '';
				document.getElementById('betTotalResultInfo').textContent = '';
			}

			// æ¸…ç©ºä¹‹å‰çš„é€‰æ‹©
			selectedDice = [];
			selectedSizes = [];
			selectedQuads = []; // é‡ç½®å››è”é€‰é¡¹
			resetDiceOptions(); // é‡ç½®é€‰é¡¹æ ·å¼
			betModal.style.display = 'block'; // æ˜¾ç¤ºå¼¹çª—
		});

        // å…³é—­å¼¹çª—
        closeModal.addEventListener('click', () => {
            betModal.style.display = 'none';
        });

        // å–æ¶ˆä¸‹æ³¨
        cancelBetButton.addEventListener('click', () => {
            betModal.style.display = 'none';
        });

        // é€‰æ‹©ç‚¹æ•°
        pointOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');

                // åˆ‡æ¢ç‚¹æ•°é€‰æ‹©
                if (selectedDice.includes(value)) {
                    selectedDice = selectedDice.filter(dice => dice !== value);
                    option.classList.remove('selected');
                } else {
                    selectedDice.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // é€‰æ‹©å¤§å°
        sizeOptions.forEach(option => {
            option.addEventListener('click', () => {
                const value = option.getAttribute('data-value');

                // åˆ‡æ¢å¤§å°é€‰æ‹©
                if (selectedSizes.includes(value)) {
                    selectedSizes = selectedSizes.filter(size => size !== value);
                    option.classList.remove('selected');
                } else {
                    selectedSizes.push(value);
                    option.classList.add('selected');
                }
            });
        });

        // ç¡®è®¤ä¸‹æ³¨
        confirmBetButton.addEventListener('click', () => {
			if (selectedDice.length > 0 || selectedSizes.length > 0 || selectedQuads.length > 0) {
				// è®¡ç®—æ€»ä¸‹æ³¨é‡‘é¢
				const pointCost = selectedDice.length * 100; // æ¯ä¸ªç‚¹æ•°ä¸‹æ³¨100
				const sizeCost = selectedSizes.length * 300; // æ¯ä¸ªå¤§å°ä¸‹æ³¨300
				const quadCost = selectedQuads.length * 100; // æ¯ä¸ªå››è”ä¸‹æ³¨100
				const totalCost = pointCost + sizeCost + quadCost;

				const currentBalance = parseInt(balanceAmount.textContent, 10);

				if (currentBalance >= totalCost) {
					// æ›´æ–°å•ç‚¹ä¸‹æ³¨ä¿¡æ¯
					if (selectedDice.length > 0) {
						document.getElementById('betPointsInfo').textContent = `å•ç‚¹ä¸‹æ³¨: ${selectedDice.join(', ')}, èŠ±è´¹: -${pointCost}`;
					} else {
						document.getElementById('betPointsInfo').textContent = ''; // æ¸…ç©ºå•ç‚¹ä¸‹æ³¨ä¿¡æ¯
					}

					// æ›´æ–°å¤§å°ä¸‹æ³¨ä¿¡æ¯
					if (selectedSizes.length > 0) {
						document.getElementById('betSizeInfo').textContent = `å¤§å°ä¸‹æ³¨: ${selectedSizes.join(', ')}, èŠ±è´¹: -${sizeCost}`;
					} else {
						document.getElementById('betSizeInfo').textContent = ''; // æ¸…ç©ºå¤§å°ä¸‹æ³¨ä¿¡æ¯
					}

					// æ›´æ–°å››è”ä¸‹æ³¨ä¿¡æ¯
					if (selectedQuads.length > 0) {
						document.getElementById('betQuadInfo').textContent = `å››è”ä¸‹æ³¨: ${selectedQuads.join(', ')}, èŠ±è´¹: -${quadCost}`;
					} else {
						document.getElementById('betQuadInfo').textContent = ''; // æ¸…ç©ºå››è”ä¸‹æ³¨ä¿¡æ¯
					}

					// æ¸…ç©ºè¾“èµ¢ç»“æœ
					document.getElementById('betTotalResultInfo').textContent = '';

					betModal.style.display = 'none';
					betPoints = selectedDice; // è®°å½•ä¸‹æ³¨çš„ç‚¹æ•°
					betSizes = selectedSizes; // è®°å½•ä¸‹æ³¨çš„å¤§å°
					betQuads = selectedQuads; // è®°å½•ä¸‹æ³¨çš„å››è”
					betAmount = totalCost;   // è®°å½•ä¸‹æ³¨é‡‘é¢

					// æ˜¾ç¤ºé¢„æ‰£é™¤åçš„é‡‘é¢
					balanceAmount.textContent = currentBalance - totalCost;

					selectedDice = [];      // æ¸…ç©ºå·²é€‰æ‹©çš„ç‚¹æ•°
					selectedSizes = [];     // æ¸…ç©ºå·²é€‰æ‹©çš„å¤§å°
					selectedQuads = [];     // æ¸…ç©ºå·²é€‰æ‹©çš„å››è”
					resetDiceOptions();    // é‡ç½®ç‚¹æ•°é€‰æ‹©ç•Œé¢
				} else {
					alert('ä½™é¢ä¸è¶³ï¼');
				}
			} else {
				alert('è¯·é€‰æ‹©è‡³å°‘ä¸€ä¸ªç‚¹æ•°ã€å¤§å°æˆ–å››è”ï¼');
			}
		});

        // é‡ç½®ç‚¹æ•°é€‰é¡¹
        function resetPointOptions() {
            pointOptions.forEach(option => {
                option.classList.remove('selected');
            });
        }

        // é‡ç½®å¤§å°é€‰é¡¹
        function resetSizeOptions() {
            sizeOptions.forEach(option => {
                option.classList.remove('selected');
            });
        }
        
        // é‡ç½®å››è”é€‰é¡¹
        function resetQuadOptions() {
            quadOptions.forEach(option => {
                option.classList.remove('selected');
            });
        }

        // é‡ç½®æ‰€æœ‰é€‰é¡¹
        function resetDiceOptions() {
            resetPointOptions();
            resetSizeOptions();
            resetQuadOptions(); // å¢åŠ é‡ç½®å››è”é€‰é¡¹çš„é€»è¾‘
        }
    </script>
</body>
</html>
